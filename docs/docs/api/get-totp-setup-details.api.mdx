---
id: get-totp-setup-details
title: "Get TOTP Setup Details"
description: "Get a TOTP secret, recovery codes and a TOTP URL."
sidebar_label: "Get TOTP Setup Details"
hide_title: true
hide_table_of_contents: true
api: eJztWetvGzcS/1fYLdA2wq7kOv1w0KcaeV2uuYsRy0gK24ipXUrimUtuSa4VwdD/fjND7ktSWidpi6JnwIC8y+E8fvPgcPYu8XzpkulFMlub7DnPvbHspPYrob3MuZdGJ1dpUgiXW1nR4zR5ITzjbPZ6dsqcyK3wKbMiN7fCblhugJZxXTQU529ejS/1bCUdgz9gzBbSOs+cFxXzhgnN50rqZaDmjh0/P2Gl8CtTwL6fTc1yrpkS3GpWGisYn5vaAyPgdrESVlx9t/K+ctPJxAGbWnEr/WYM7K0wt2NpJoXJ3WRZS1BswsG0iQdTF2Tq1074unoEglBFwWonLNNCFA5Vc/xWkMYHrANKWgLzGECG/wYsaCP81BVZIjWuSUsPvKqiKFA+kq+lUmwOu0EdUQC9A0WJ37U3N0Jfg1DtudS0GNVxldFONLg2hPCvFb/UEvk0yArCFShPhV0YWyLShB1SChfla+NZvuJ6GSQjDN+Chp570QgtuOdzHoUCtsBMpLRC0hvnog9AaGWk9swsmLeAOANidsuVLCiigMUzgnOgw1JoYVEgBw+sh+GFLw6GWEsZwix4kZxKYQO45qaslPAIycqaerkiNYUugoqX+uL69PXZjE14JUN4HC/4xBtfTYjP9f3iC3cHwDPcm3GXdWGWhXh+dKlrFxzQeTfYgdGBdrGFNSW8Y7zLQcCuCZzR6E1wcAlrbjoaXeqMtYGbD/fhW5RWcefWxhZjktL6G17dwBN45zUm/PEYsGDELDyzyppbiEUbtkT3iSbUDegdrGNy0UZNDDoIVU9Ox/cNnzHyRxtmaHmj/UngzC6uT/JcOEeL9wR9kNTE9GtOTDJ6etTPiPFQ2BmUn/PqC4VhDcvqKkpD8/oCGSVnyA63MrUqWMl9vgpAod8dqAr5sJ/hAyzGSZqID6CN5uopaJJM75LaKijEX1r4km2amAqzDrR4WQDHpfAzCN8zXH0qQCnlQHpTcEj08dER/gyPBAybXzkQ0jZJo92YoIQMGofmQ8wi19FkhD8uX4mS439+Uwngb+b/FbkHWggmUNjLoEuQ1qNz3gIWaBdmIcbxOSJ1YL1R8Anq16Pg1vINCJJelO7ATmINih9eapyPJ+pQQtoo2+wfqgiHrJdeITs4icNBTF54E7EH9ijg8dEP++ifU0ApK3ixaTOQ6v4XoetlCdWZl9W+rWmChwkHrgkWhQxJEVU8Muo+bFBjxVLY/gZ49fgYiYW1xh50Dsh1fCkOrlXcr34b/MC7VSjtGdOD+hlS7SD8w6H4pvrMNdbNuWghxgqHyezYemVYIQv9rcdkXshljZ3KoI+K1Zh39fjBOZ/hnO/3nTOoltiNDao71mSpqe4/IP6piG+pbNV4sgCbu4R3SP8Tqg1YMr24QrYt3t3rbTqgf2LMjRR79N3r7RVaio1SOIiSxrjkY70ZFVULNdaRcvc5FJPdy8xTUWLDjlwS1LhjAjyUyblaGeen/ziCsrC79xUus0LcCmUqbMlaRlcdbmcYXjGCmso+vGENcOgOokr+JDZ7MomYKo+rCdxFrXYrDXV1ENNS0XHbFJwU8qAgGqhDdDnpdSsHblqfe70KzVGv/R2qF9slTEbNSzQVSN8H0vdD0vfNUSnR9DxABDF5IAxb3FDdPdRChYjNWFO2d2Abs98dg0E3igZTrUEt5yCC6kD453lTDf71drZj4H0D414m/vEWRpeG9x/z34H8/4S4x8kB9I87Qc+VMms6YQMQcPmkFKT7sqktvPz9zR/eAHr248L7uvoYAL9WCfYi+v+oErzLujlUNsQmm/WhXAWQ6JhbgINXn1AM3oQdMVW8aecQOE3gvTT6AwImavsZJeHAGfs3y5l3GfZt2Xl1H1fft278tZwdLY0Lh6vDFp8XJrScoTE76+Syk9OXe0a+FSo3JY7iaHww6tGPvmLtyBH0rLFNCc6n26mLE0W4OYKaGY41m9mYg40YO8OYScO5UnINHSkyS6myxLa69x4Yc7wNlTgBEll7LSpCUbrUAy3jeOu5gP7U4ngPR8wvFNe5GI2muJix0WhYEdg3jG6+/25lTkcj9lLnqsYJIeQN6R7k2X4cuBSrXkoTr1AdAQq5aE1Ei6xRIsOJZ9GECdoIb+McC/V5yj0HLZ5E44eKPGtxRBSx87dQ1zDbSCF+CDNk7TYQWmWAz9VVZSywKGvlZQZ4LGugbbam7W2TRr2eL5fAP+g/r6XymdTEc8cCdoI+IQp2fQI3nFyJa5YrOB7wKODKmWZsV/TMjTNkdApYfRYbXLQV5z8QmLg5cI0mLiDioKxo5FbUOdVxDDapQZ2AvyR/ISw0/VWylARSGBTRjDwAFDBc2t7JBu41UCTBRTdiAx7zzXw5BnxUCfWodRg+kzNQxyDSzGuoBXOeQ1QU1L7LHOdVpcyt6R5hDyRDrVQGl6b8BgeyKkaLi6H7H+MFQnGGEd/lUDxWmfiAO2Q3HwjaQMZ2A4Xmfgphgtkfi8VZKDSwtnPB6V9qKIqpiND2H3uLUE9AssArXcf0xemr28fsVXy/y3q9Xo+Xuh4bu5zEvVDgKpU9Hh+NhR6vfKmQLxaQUIG+h4Ujuo/CbQn81RcFHqTxH82zWDdWHNSwu+5m/vCB6eED08MHpocPTA8fmP68D0yxifbig59UCmixltfh20mYwl1ghw2UqB/8QBDHTxg0hcNp3FWa4KwMSe/uMJXPrdpu8TVkod2E0d8tGI8eDBPCprnH8R0c4XGMUeHsD4CsUSWc0g5Ggy+ezRo1uu5/5/JEDJuLgd702IFmREGmg3ZplBta8e3Vdrv9Hzxdv2g=
sidebar_class_name: "get api-method"
info_path: docs/api/singularity-api
custom_edit_url: null
---

import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import ParamsDetails from "@theme/ParamsDetails";
import RequestSchema from "@theme/RequestSchema";
import StatusCodes from "@theme/StatusCodes";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";
import Heading from "@theme/Heading";

<Heading
  as={"h1"}
  className={"openapi__heading"}
  children={"Get TOTP Setup Details"}
>
</Heading>

<MethodEndpoint
  method={"get"}
  path={"/api/auth/2fa/totp/setup"}
  context={"endpoint"}
>
  
</MethodEndpoint>



Get a TOTP secret, recovery codes and a TOTP URL.
This is the first step to enabling TOTP as 2FA method.
You can learn more about this [here](https://singularity.stereov.io/docs/guides/auth/two-factor#setup).

The user needs to save the recovery codes and use the URL or the secret to set up 2FA in their 2FA app.

This secret will be stored inside the `token` contained in the response.
This `token` is required to enable TOTP.
Performing this request will not change the user's state in the database.
Therefore, the token is the single point of truth for validation.
Every request will generate a new TOTP secret, new recovery codes and a new TOTP URL.

The setup can be completed through the endpoint 
[`POST /api/auth/2fa/totp/setup`](https://singularity.stereov.io/docs/api/enable-totp-as-two-factor-method)
using the `token` and a 2FA code from an authenticator app.

**Requirements:**
- The user can authenticate using password. 2FA will not work with OAuth2. 
  The OAuth2 provider will validate the second factor if the user enabled it for the provider.
  
**Tokens:**
- A valid [`AccessToken`](https://singularity.stereov.io/docs/guides/auth/tokens#access-token) is required.
- A valid [`StepUpToken`](https://singularity.stereov.io/docs/guides/auth/tokens#step-up-token)
  is required. This token should match user and session contained in the `AccessToken`.

<ParamsDetails
  parameters={undefined}
>
  
</ParamsDetails>

<RequestSchema
  title={"Body"}
  body={undefined}
>
  
</RequestSchema>

<StatusCodes
  id={undefined}
  label={undefined}
  responses={{"200":{"description":"The TOTP secret, recovery codes, TOTP URL and setup token.","content":{"*/*":{"schema":{"type":"object","properties":{"secret":{"type":"string"},"totpAuthUrl":{"type":"string"},"recoveryCodes":{"type":"array","items":{"type":"string"}},"token":{"type":"string"}},"required":["recoveryCodes","secret","token","totpAuthUrl"],"title":"TwoFactorSetupResponse"}}}},"304":{"description":"User already enabled TOTP.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}},"400":{"description":"2FA cannot be enabled for users who didn't configure authentication using a password.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}},"401":{"description":"`AccessToken` or `StepUpToken` is invalid.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}}}}
>
  
</StatusCodes>


      