---
id: get-totp-setup-details
title: "Get TOTP Setup Details"
description: "Get a TOTP secret, recovery codes and a TOTP URL."
sidebar_label: "Get TOTP Setup Details"
hide_title: true
hide_table_of_contents: true
api: eJztWG1z2zYS/isoO9MXDSm5Tj/c+dN58nZpkzYTy9POJJ4EJiEKZwhgAdCKxuP/3mcBUCQlxWf3Zq5f7A+WRC52H+w+u9jFTeZ57bKT99l8bYoXvPTGstPWL4X2suReGp1d5FklXGllE36eZC+FZ5zNf52/ZU6UVvicWVGaa2E3rDSQZVxXncT5u9fTD3q+FKx1wjItROWYN8zxa8Fg59BSSIZXWMuAh75GQ2EhPtqGHb84ZVLTO2nDD940MESmpOvE11IpdonV2JaoIO9kFVV7cyU0TGrPpQ6vEhjXGO3ENOmJYvhixR+tJB1AIDS/VCJsD3JvhV0Yu5K6hoYkKVyyrY1n5ZLrOlolF3wLdJ570ZmsuOeXPJkUVkCZyAcYCQU5AAZgtDFSe2YWzFtEiUGYXXMlqxAqqHgeXDnCUAstLBnk8P56HDd6cDB2W8kYv+QO8ANmOmfgdzTOPp150Zw3cwL8KYmngK9a4EAIgsvgPN6TiyTIbZw13Lm1sRWWvlpsPQU7tXRekNuj5K9EzeMAsYJZ8u77xIdOxdAAsF58t/S+cSezGSloFbfSb6ZBqbmeSjOrTOlmdQteuBktnRn6f/w1ryosKDq1xVjt9/kH7QceCY5ecKmwgyzPxGcY0Fw9g/Ls5CZrrULePBSJR0ouQkp+jU22TXabZ6ahWMLkqwoaa+Hnxjdn9PaZAJWVg/WOxMH08dERfYwz+INmB/4oZndkdb4lRAhAgBQ5Oj2s7/DTs6VZD1J6oBXs6EI//cJiQAQarrclIiU60iBpuLs83B/mG34F7a3tEzeULHeoZsFQySOgDVMGhOdlKZxLO/qLCObDEvDl+rO7DASgsgauUtwnswl9uHIpVpy++U0jwABz+R9Resg2lijlZWRLdOdAznkLthLzPIhG6XdOXD7wvvPJU3LJQIJbyzcwJL1YuQMrg2rs8vCrbt90RI0t5B3Ybv0YIk4tL70idTja4skW8uRdyg6oJwM/Hv2wnx+nIXyhnBG1BtWNYiF1qHrT/8nTXq5Qofmq2d93ntGBwqE1Q10XBYmSh+nYaIcuxFEgamGHC/DoyTEJC2uNPRgo2HW8FgffNdwv/3sgou4toHywmYHbn5PUnref7Ht7e1Z0NR1eXciacm9cddMpsD0tHgPwFwLwzzsCwJUVvNqkClPFEvPo5Qd6+TaUppbOd6i5yXhfTf4N92InJ+8vSO22qvSPb/OR/FNjrqTYk+8f317QTv3SpHYg6zaXzXgjYx9xvOAzKo2z2EUQOos66gK4+7Qm2e4E8Eys6KQlLRkh7pVAhzIlV0ucgif/OELzsbv2Nb1mlbgWyjQrsGqr6KL32xnRKzGoq97jsWTkh/6waeTPYrNnM5ZuapZdG5y7aNVubVlL9NPgtFShvemKTI5yXwUZVJ7QVfSHMaWG5isyDJQfY6/2caz3Y3c4SQJSRsBgyAFSbHdBjtzbw2nXUnRbiRk7MkaAQmaSlkvBbcia+OVFlzs//TbfAXBfN94XQvJJtPAlBxyg8wPCiMXU5u3EkCtl1mGkiEgxJwVGhcHOtBYPB/hIyce2+RLAu4i3F7K/jXi/F/3kXoyRFvPhxpYRcqhxC7hj+QDuvYsrUuTRgnYDJo2JfMAK9xAGHiiA/2cG/F5Qa1ecN/dx1X1Z+jBnJSTJ0GEu3tLvhYnnaTx1zvpCzU7fvtoD8ZtQpVmJbqaaDOQnX7HtQI+Zs6UaHJ0X2utuwkEfUHhT0KAldBXuHRwWku/HPs/ToM81jltSlgcep55h8ByKOTV3gNVYUWy7vCqmwAc9QhmuESaTFwKHb7hroEunl4rrUkwmJ/SyYJPJmPHsG3ZOWN5sbZ5MJuyVLlVLcxp4F7BHe3YYJ0y3yLE8jGIxF+EKudhukXZkjRIFXdVUXRhpj3gaprCI5xn3HCieps2PgTzf+pG8SG2NpfsDsDUA4od8RqrdBmxfRfe5tmmMhYpVq7ws4I+6hWy3NN82z/HChdc19Ef8l61UvsCwSjp3dsBOKSZBgn06RftWKvGJlQrFiAoPV85AwFzLSlSD7abLLwoKdn2WTm/aK/WUICYtjlrTFhdgHNJSk7aqDbcnBZFNasCJ/pchXuSWcG2l5EoGJ8VbhzDvRwdFH9Z2UEcRXoMigxBdYRa3xncXY4nwCRLhaHW8NQvBIIzRpLkMN1a8BCuq0JvIki4/VrK0pv+JNUiGVqkCHWF5RdO9Smxxibq/GC/IFWfE+D6HUhFn4jOtkP24E9EgYy9F14F3zTdoQtmfisVZ7Mzwbqd7G3ZsgcWhiITl/xq8RD2BZUH9aq/05dvX10/Y6/R8V/V6vZ7Wup0aW8/SWjerG1U8mR5NhZ4u/UqRXiogsQL9gBdHodlGK4h4DU0hguHWJwzkrL+5GtWwm37seLxyfrxyfrxyvvPKOfUkXnz2s0aBYZR6bbyrixPhe2pYIElq8YGpMF2ZhYmQJkMMYDS3kejNDRHk3KrbW3qM2NpNHEOvsR/ybJxWu16JRklU3DQkNDSHIk4tQaIbg9GY+vL5vIPRN1M7vWJQ2PVZejNQB2RBIkQe6PJkN3ZOtxeYv/8EfBRMSg==
sidebar_class_name: "get api-method"
info_path: docs/api/singularity-api
custom_edit_url: null
---

import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import ParamsDetails from "@theme/ParamsDetails";
import RequestSchema from "@theme/RequestSchema";
import StatusCodes from "@theme/StatusCodes";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";
import Heading from "@theme/Heading";

<Heading
  as={"h1"}
  className={"openapi__heading"}
  children={"Get TOTP Setup Details"}
>
</Heading>

<MethodEndpoint
  method={"get"}
  path={"/api/auth/2fa/totp/setup"}
  context={"endpoint"}
>
  
</MethodEndpoint>



Get a TOTP secret, recovery codes and a TOTP URL.
The user needs to save the recovery codes and use the URL or the secret to set up 2FA in their 2FA app.

This secret will be stored inside the token contained in the response.
This token is required to enable TOTP.
Performing this request will not change the user's state in the database.
Therefore, the token is the single point of truth for validation.
Every request will generate a new TOTP secret, new recovery codes and a new TOTP URL.

This action requires a valid `StepUpToken`.

The user must be able to authenticate using a password.
If the user registered using OAuth2 and did not [set up password authentication](https://singularity.stereov.io/docs/guides/auth/oauth2#adding-password-authentication),
this action will fail.


<ParamsDetails
  parameters={undefined}
>
  
</ParamsDetails>

<RequestSchema
  title={"Body"}
  body={undefined}
>
  
</RequestSchema>

<StatusCodes
  id={undefined}
  label={undefined}
  responses={{"200":{"description":"\n                    The TOTP secret, recovery codes, TOTP URL and setup token.\n                    \n                    Show the secret, TOTP URL to the user. \n                    They can use the secret or URL to set up 2FA in their 2FA app.\n                    \n                    Make sure the user saves the recovery codes in case they lost access to their 2FA app.\n                    \n                    The token is required to enable TOTP.\n                ","content":{"*/*":{"schema":{"type":"object","properties":{"secret":{"type":"string"},"totpAuthUrl":{"type":"string"},"recoveryCodes":{"type":"array","items":{"type":"string"}},"token":{"type":"string"}},"required":["recoveryCodes","secret","token","totpAuthUrl"],"title":"TwoFactorSetupResponse"}}}},"401":{"description":"AccessToken or StepUpToken is invalid.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}},"403":{"description":"The user did not configure authentication using password.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}},"409":{"description":"The user already enabled TOTP.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}}}}
>
  
</StatusCodes>


      