---
id: get-totp-setup-details
title: "Get TOTP Setup Details"
description: "Get a TOTP secret, recovery codes and a TOTP URL."
sidebar_label: "Get TOTP Setup Details"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "get api-method"
info_path: docs/api/singularity-api
custom_edit_url: null
---

import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import ParamsDetails from "@theme/ParamsDetails";
import RequestSchema from "@theme/RequestSchema";
import StatusCodes from "@theme/StatusCodes";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";
import Heading from "@theme/Heading";

<Heading
  as={"h1"}
  className={"openapi__heading"}
  children={"Get TOTP Setup Details"}
>
</Heading>

<MethodEndpoint
  method={"get"}
  path={"/api/auth/2fa/totp/setup"}
  context={"endpoint"}
>
  
</MethodEndpoint>



Get a TOTP secret, recovery codes and a TOTP URL.
This is the first step to enabling TOTP as 2FA method.
You can learn more about this [here](../../docs/guides/auth/two-factor#setup).

The user needs to save the recovery codes and use the URL or the secret to set up 2FA in their 2FA app.

This secret will be stored inside the `token` contained in the response.
This `token` is required to enable TOTP.
Performing this request will not change the user's state in the database.
Therefore, the token is the single point of truth for validation.
Every request will generate a new TOTP secret, new recovery codes and a new TOTP URL.

The setup can be completed through the endpoint 
[`POST /api/auth/2fa/totp/setup`](../../docs/api/enable-totp-as-two-factor-method)
using the `token` and a 2FA code from an authenticator app.

### Requirements
- The user can authenticate using password. 2FA will not work with OAuth2. 
  The OAuth2 provider will validate the second factor if the user enabled it for the provider.
  
### Tokens
- A valid [`AccessToken`](../../docs/guides/auth/tokens#access-token) is required.
- A valid [`StepUpToken`](../../docs/guides/auth/tokens#step-up-token)
  is required. This token should match user and session contained in the `AccessToken`.

<ParamsDetails
  parameters={undefined}
>
  
</ParamsDetails>

<RequestSchema
  title={"Body"}
  body={undefined}
>
  
</RequestSchema>

<StatusCodes
  id={undefined}
  label={undefined}
  responses={{"200":{"description":"The TOTP secret, recovery codes, TOTP URL and setup token.","content":{"*/*":{"schema":{"type":"object","properties":{"secret":{"type":"string"},"totpAuthUrl":{"type":"string"},"recoveryCodes":{"type":"array","items":{"type":"string"}},"token":{"type":"string"}},"required":["recoveryCodes","secret","token","totpAuthUrl"],"title":"TwoFactorSetupResponse"}}}},"304":{"description":"The following error codes correspond to this status:\n* **`TWO_FACTOR_METHOD_ALREADY_ENABLED`:** Two-factor authentication method is already enabled.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"400":{"description":"The following error codes correspond to this status:\n* **`NO_PASSWORD_PROVIDER`:** The user needs to set a password in to perform this action.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"401":{"description":"The following error codes correspond to this status:\n* **`ACCESS_TOKEN_EXPIRED`:** Indicates that the access token is expired.\n* **`ACCESS_TOKEN_INVALID`:** Indicates that the access token cannot be decoded.\n* **`STEP_UP_TOKEN_EXPIRED`:** Indicates that the step-up token is expired.\n* **`STEP_UP_TOKEN_INVALID`:** Indicates that the step-up token cannot be decoded.\n* **`STEP_UP_TOKEN_MISSING`:** Thrown when the step-up token is missing.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"404":{"description":"The following error codes correspond to this status:\n* **`USER_NOT_FOUND`:** User not found.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"500":{"description":"The following error codes correspond to this status:\n* **`ACCESS_TOKEN_ALLOWLIST_READING_FAILURE`:** Represents an exception indicating a failure when reading the allowlist for an access token cache.\n* **`DATABASE_FAILURE`:** Exception representing a general failure related to database operations.\n* **`DATABASE_ENCRYPTION_FAILURE`:** Exception representing a general failure related to database encryption operations.\n* **`INVALID_CONFIGURATION`:** Invalid configuration.\n* **`INVALID_USER_DOCUMENT`:** A requested user document was stored in an invalid format.\n* **`TOTP_TOKEN_CREATION_FAILURE`:** Failed to create TOTP token.\n* **`TOTP_FAILURE`:** TOTP code validation failed.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}}}}
>
  
</StatusCodes>


      