---
id: complete-step-up
title: "Complete Step-Up"
description: "Perform second factor for step-up."
sidebar_label: "Complete Step-Up"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "post api-method"
info_path: docs/api/singularity-api
custom_edit_url: null
---

import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import ParamsDetails from "@theme/ParamsDetails";
import RequestSchema from "@theme/RequestSchema";
import StatusCodes from "@theme/StatusCodes";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";
import Heading from "@theme/Heading";

<Heading
  as={"h1"}
  className={"openapi__heading"}
  children={"Complete Step-Up"}
>
</Heading>

<MethodEndpoint
  method={"post"}
  path={"/api/auth/2fa/step-up"}
  context={"endpoint"}
>
  
</MethodEndpoint>



Perform second factor for step-up.

You can learn more about the step-up flow [here](../../docs/guides/auth/authentication#step-up).

### Requirements
- User authenticated using their password through [`POST /api/auth/step-up`](../../docs/api/step-up).
- At least one of [email](../../docs/guides/auth/two-factor#email) or [TOTP](../../docs/guides/auth/two-factor#totp) as 2FA methods should be enabled.
- An `email` or `totp` 2FA code is present for an enabled 2FA method.
  Check out [email](../../docs/guides/auth/two-factor#email) and [TOTP](../../docs/guides/auth/two-factor#totp)
  to learn how to retrieve a 2FA code.

### Tokens
- A valid [`AccessToken`](../../docs/guides/auth/tokens#access-token) is required.
- A valid [`TwoFactorAuthenticationToken`](../../docs/guides/auth/tokens#two-factor-authentication-token)
  is required. This token should match user and session contained in the `AccessToken`.
- If 2FA is disabled and the request is successful, [`StepUpToken`](../../docs/guides/auth/tokens#step-up-token)
  will automatically be set as HTTP-only cookie.
  If [header authentication](../../docs/guides/auth/authentication#header-authentication) is enabled,
  the [`StepUpToken`](../../docs/guides/auth/tokens#step-up-token)
  will be returned in the response body and can be used to authorized critical requests.

<Heading
  id={"request"}
  as={"h2"}
  className={"openapi-tabs__heading"}
  children={"Request"}
>
</Heading>

<ParamsDetails
  parameters={undefined}
>
  
</ParamsDetails>

<RequestSchema
  title={"Body"}
  body={{"content":{"application/json":{"schema":{"type":"object","properties":{"email":{"type":"string"},"totp":{"type":"integer","format":"int32"}},"title":"CompleteStepUpRequest"}}},"required":true}}
>
  
</RequestSchema>

<StatusCodes
  id={undefined}
  label={undefined}
  responses={{"200":{"description":"The token if header authentication is enabled.","content":{"*/*":{"schema":{"type":"object","properties":{"stepUpToken":{"type":"string"},"twoFactorRequired":{"type":"boolean"},"twoFactorMethods":{"type":"array","items":{"type":"string","enum":["totp","email"]}},"preferredTwoFactorMethod":{"type":"string","enum":["totp","email"]},"twoFactorAuthenticationToken":{"type":"string"}},"required":["twoFactorRequired"],"title":"StepUpResponse"}}}},"400":{"description":"The following error codes correspond to this status:\n* **`NO_2FA_CODE_PROVIDED`:** Invalid request: at least one of email or totp must be provided.\n* **`NO_PASSWORD_PROVIDER`:** The user needs to set a password in to perform this action.\n* **`2FA_DISABLED`:** User needs to set up two-factor authentication to complete this action.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"401":{"description":"The following error codes correspond to this status:\n* **`TWO_FACTOR_AUTHENTICATION_TOKEN_EXPIRED`:** Indicates that the two-factor authentication token is expired.\n* **`TWO_FACTOR_AUTHENTICATION_TOKEN_INVALID`:** Indicates that the two-factor authentication token cannot be decoded.\n* **`TWO_FACTOR_AUTHENTICATION_TOKEN_MISSING`:** Thrown when the two-factor authentication token is missing.\n* **`TWO_FACTOR_CODE_EXPIRED`:** Two-factor code has expired.\n* **`WRONG_TWO_FACTOR_CODE`:** Wrong two-factor code.\n* **`ACCESS_TOKEN_EXPIRED`:** Indicates that the access token is expired.\n* **`ACCESS_TOKEN_INVALID`:** Indicates that the access token cannot be decoded.\n* **`AUTHENTICATION_REQUIRED`:** User is not authenticated.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"403":{"description":"The following error codes correspond to this status:\n* **`STEP_UP_TOKEN_CREATION_FORBIDDEN`:** Thrown when a step-up token is requested from an illegal context.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"404":{"description":"The following error codes correspond to this status:\n* **`USER_NOT_FOUND`:** User not found.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"500":{"description":"The following error codes correspond to this status:\n* **`DATABASE_FAILURE`:** Exception representing a general failure related to database operations.\n* **`INVALID_USER_DOCUMENT`:** A requested user document was stored in an invalid format.\n* **`POST_COMMIT_SIDE_EFFECT_FAILURE`:** Exception representing a failure to perform a side effect after a successful database operation.\n* **`TOTP_CODE_VALIDATION_FAILURE`:** Failed to validate TOTP code.\n* **`ACCESS_TOKEN_ALLOWLIST_READING_FAILURE`:** Represents an exception indicating a failure when reading the allowlist for an access token cache.\n* **`INVALID_DATABASE_OBJECT`:** Indicates an invalid document stored in the database.\n* **`STEP_UP_TOKEN_ENCODING_FAILURE`:** Represents an exception that occurs during the encoding process of a step-up token.\n* **`STEP_UP_TOKEN_SECRET_FAILURE`:** Represents an exception that occurs when there is a failure related to the secret required for creating a refresh token.\n* **`COOKIE_CREATION_FAILURE`:** Thrown when an exception occurred during the creation of a cookie.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}}}}
>
  
</StatusCodes>


      