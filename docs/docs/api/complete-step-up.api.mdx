---
id: complete-step-up
title: "Complete Step-Up"
description: "Perform second factor for step-up."
sidebar_label: "Complete Step-Up"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "post api-method"
info_path: docs/api/singularity-api
custom_edit_url: null
---

import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import ParamsDetails from "@theme/ParamsDetails";
import RequestSchema from "@theme/RequestSchema";
import StatusCodes from "@theme/StatusCodes";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";
import Heading from "@theme/Heading";

<Heading
  as={"h1"}
  className={"openapi__heading"}
  children={"Complete Step-Up"}
>
</Heading>

<MethodEndpoint
  method={"post"}
  path={"/api/auth/2fa/step-up"}
  context={"endpoint"}
>
  
</MethodEndpoint>



Perform second factor for step-up.

You can learn more about the step-up flow [here](../../docs/guides/auth/authentication#step-up).

### Requirements
- User authenticated using their password through [`POST /api/auth/step-up`](../../docs/api/step-up).
- At least one of [email](../../docs/guides/auth/two-factor#email) or [TOTP](../../docs/guides/auth/two-factor#totp) as 2FA methods should be enabled.
- An `email` or `totp` 2FA code is present for an enabled 2FA method.
  Check out [email](../../docs/guides/auth/two-factor#email) and [TOTP](../../docs/guides/auth/two-factor#totp)
  to learn how to retrieve a 2FA code.

### Tokens
- A valid [`AccessToken`](../../docs/guides/auth/tokens#access-token) is required.
- A valid [`TwoFactorAuthenticationToken`](../../docs/guides/auth/tokens#two-factor-authentication-token)
  is required. This token should match user and session contained in the `AccessToken`.
- If 2FA is disabled and the request is successful, [`StepUpToken`](../../docs/guides/auth/tokens#step-up-token)
  will automatically be set as HTTP-only cookie.
  If [header authentication](../../docs/guides/auth/authentication#header-authentication) is enabled,
  the [`StepUpToken`](../../docs/guides/auth/tokens#step-up-token)
  will be returned in the response body and can be used to authorized critical requests.

<Heading
  id={"request"}
  as={"h2"}
  className={"openapi-tabs__heading"}
  children={"Request"}
>
</Heading>

<ParamsDetails
  parameters={undefined}
>
  
</ParamsDetails>

<RequestSchema
  title={"Body"}
  body={{"content":{"application/json":{"schema":{"type":"object","properties":{"email":{"type":"string"},"totp":{"type":"integer","format":"int32"}},"title":"CompleteStepUpRequest"}}},"required":true}}
>
  
</RequestSchema>

<StatusCodes
  id={undefined}
  label={undefined}
  responses={{"200":{"description":"The token if header authentication is enabled.","content":{"*/*":{"schema":{"type":"object","properties":{"stepUpToken":{"type":"string"},"twoFactorRequired":{"type":"boolean"},"twoFactorMethods":{"type":"array","items":{"type":"string","enum":["totp","email"]}},"preferredTwoFactorMethod":{"type":"string","enum":["totp","email"]},"twoFactorAuthenticationToken":{"type":"string"}},"required":["twoFactorRequired"],"title":"StepUpResponse"}}}},"207":{"description":"The following error codes correspond to this status:\n* **`POST_COMMIT_SIDE_EFFECT_FAILURE`:** Exception representing a failure to perform a side effect after a successful database operation.","content":{"application/json":{"schema":{}}}},"400":{"description":"The following error codes correspond to this status:\n* **`NO_2FA_CODE_PROVIDED`:** Invalid request: at least one of email or totp must be provided.\n* **`NO_PASSWORD_PROVIDER`:** The user needs to set a password in to perform this action.\n* **`2FA_DISABLED`:** User needs to set up two-factor authentication to complete this action.","content":{"application/json":{"schema":{}}}},"401":{"description":"The following error codes correspond to this status:\n* **`TWO_FACTOR_AUTHENTICATION_TOKEN_EXPIRED`:** Indicates that the two-factor authentication token is expired.\n* **`TWO_FACTOR_AUTHENTICATION_TOKEN_INVALID`:** Indicates that the two-factor authentication token cannot be decoded.\n* **`TWO_FACTOR_AUTHENTICATION_TOKEN_MISSING`:** Thrown when the two-factor authentication token is missing.\n* **`TWO_FACTOR_CODE_EXPIRED`:** Two-factor code has expired.\n* **`TOTP_CODE_VALIDATION_FAILURE`:** Failed to validate TOTP code.\n* **`WRONG_TWO_FACTOR_CODE`:** Wrong two-factor code.\n* **`ACCESS_TOKEN_EXPIRED`:** Indicates that the access token is expired.\n* **`ACCESS_TOKEN_INVALID`:** Indicates that the access token cannot be decoded.","content":{"application/json":{"schema":{}}}},"403":{"description":"The following error codes correspond to this status:\n* **`STEP_UP_TOKEN_CREATION_FORBIDDEN`:** Thrown when a step-up token is requested from an illegal context.","content":{"application/json":{"schema":{}}}},"404":{"description":"The following error codes correspond to this status:\n* **`USER_NOT_FOUND`:** User not found.","content":{"application/json":{"schema":{}}}},"500":{"description":"The following error codes correspond to this status:\n* **`DATABASE_FAILURE`:** Exception representing a general failure related to database operations.\n* **`INVALID_USER_DOCUMENT`:** A requested user document was stored in an invalid format.\n* **`ACCESS_TOKEN_ALLOWLIST_READING_FAILURE`:** Represents an exception indicating a failure when reading the allowlist for an access token cache.\n* **`STEP_UP_TOKEN_ENCODING_FAILURE`:** Represents an exception that occurs during the encoding process of a step-up token.\n* **`STEP_UP_TOKEN_SECRET_FAILURE`:** Represents an exception that occurs when there is a failure related to the secret required for creating a refresh token.","content":{"application/json":{"schema":{}}}}}}
>
  
</StatusCodes>


      