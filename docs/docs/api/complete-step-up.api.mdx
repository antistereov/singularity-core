---
id: complete-step-up
title: "Complete Step-Up"
description: "Perform second factor for step-up."
sidebar_label: "Complete Step-Up"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "post api-method"
info_path: docs/api/singularity-api
custom_edit_url: null
---

import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import ParamsDetails from "@theme/ParamsDetails";
import RequestSchema from "@theme/RequestSchema";
import StatusCodes from "@theme/StatusCodes";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";
import Heading from "@theme/Heading";

<Heading
  as={"h1"}
  className={"openapi__heading"}
  children={"Complete Step-Up"}
>
</Heading>

<MethodEndpoint
  method={"post"}
  path={"/api/auth/2fa/step-up"}
  context={"endpoint"}
>
  
</MethodEndpoint>



Perform second factor for step-up.

You can learn more about the step-up flow [here](../../docs/guides/auth/authentication#step-up).

### Requirements
- User authenticated using their password through [`POST /api/auth/step-up`](../../docs/api/step-up).
- At least one of [email](../../docs/guides/auth/two-factor#email) or [TOTP](../../docs/guides/auth/two-factor#totp) as 2FA methods should be enabled.
- An `email` or `totp` 2FA code is present for an enabled 2FA method.
  Check out [email](../../docs/guides/auth/two-factor#email) and [TOTP](../../docs/guides/auth/two-factor#totp)
  to learn how to retrieve a 2FA code.

### Tokens
- A valid [`AccessToken`](../../docs/guides/auth/tokens#access-token) is required.
- A valid [`TwoFactorAuthenticationToken`](../../docs/guides/auth/tokens#two-factor-authentication-token)
  is required. This token should match user and session contained in the `AccessToken`.
- If 2FA is disabled and the request is successful, [`StepUpToken`](../../docs/guides/auth/tokens#step-up-token)
  will automatically be set as HTTP-only cookie.
  If [header authentication](../../docs/guides/auth/authentication#header-authentication) is enabled,
  the [`StepUpToken`](../../docs/guides/auth/tokens#step-up-token)
  will be returned in the response body and can be used to authorized critical requests.

<Heading
  id={"request"}
  as={"h2"}
  className={"openapi-tabs__heading"}
  children={"Request"}
>
</Heading>

<ParamsDetails
  parameters={undefined}
>
  
</ParamsDetails>

<RequestSchema
  title={"Body"}
  body={{"content":{"application/json":{"schema":{"type":"object","properties":{"email":{"type":"string"},"totp":{"type":"integer","format":"int32"}},"title":"CompleteStepUpRequest"}}},"required":true}}
>
  
</RequestSchema>

<StatusCodes
  id={undefined}
  label={undefined}
  responses={{"200":{"description":"The token if header authentication is enabled.","content":{"*/*":{"schema":{"type":"object","properties":{"stepUpToken":{"type":"string"},"twoFactorRequired":{"type":"boolean"},"twoFactorMethods":{"type":"array","items":{"type":"string","enum":["totp","email"]}},"preferredTwoFactorMethod":{"type":"string","enum":["totp","email"]},"twoFactorAuthenticationToken":{"type":"string"}},"required":["twoFactorRequired"],"title":"StepUpResponse"}}}},"207":{"description":"A specific domain error occurred (see list below):\n* **`POST_COMMIT_SIDE_EFFECT_FAILURE`:** Exception representing a failure to perform a side effect after a successful database operation.\n* **`POST_COMMIT_SIDE_EFFECT_FAILURE`:** Exception representing a failure to perform a side effect after a successful database operation.","content":{"application/json":{"schema":{}}}},"400":{"description":"A specific domain error occurred (see list below):\n* **`NO_2FA_CODE_PROVIDED`:** Invalid request: at least one of email or totp must be provided.\n* **`NO_PASSWORD_PROVIDER`:** The user needs to set a password in to perform this action.\n* **`2FA_DISABLED`:** User needs to set up two-factor authentication to complete this action.\n* **`NO_2FA_CODE_PROVIDED`:** Invalid request: at least one of email or totp must be provided.\n* **`NO_PASSWORD_PROVIDER`:** The user needs to set a password in to perform this action.\n* **`2FA_DISABLED`:** User needs to set up two-factor authentication to complete this action.","content":{"application/json":{"schema":{}}}},"401":{"description":"A specific domain error occurred (see list below):\n* **`TWO_FACTOR_AUTHENTICATION_TOKEN_EXPIRED`:** Indicates that the two-factor authentication token is expired.\n* **`TWO_FACTOR_AUTHENTICATION_TOKEN_INVALID`:** Indicates that the two-factor authentication token cannot be decoded.\n* **`TWO_FACTOR_AUTHENTICATION_TOKEN_MISSING`:** Thrown when the two-factor authentication token is missing.\n* **`TWO_FACTOR_CODE_EXPIRED`:** Two-factor code has expired.\n* **`TOTP_CODE_VALIDATION_FAILURE`:** Failed to validate TOTP code.\n* **`WRONG_TWO_FACTOR_CODE`:** Wrong two-factor code.\n* **`ACCESS_TOKEN_EXPIRED`:** Indicates that the access token is expired.\n* **`ACCESS_TOKEN_INVALID`:** Indicates that the access token cannot be decoded.\n* **`TWO_FACTOR_AUTHENTICATION_TOKEN_EXPIRED`:** Indicates that the two-factor authentication token is expired.\n* **`TWO_FACTOR_AUTHENTICATION_TOKEN_INVALID`:** Indicates that the two-factor authentication token cannot be decoded.\n* **`TWO_FACTOR_AUTHENTICATION_TOKEN_MISSING`:** Thrown when the two-factor authentication token is missing.\n* **`TWO_FACTOR_CODE_EXPIRED`:** Two-factor code has expired.\n* **`TOTP_CODE_VALIDATION_FAILURE`:** Failed to validate TOTP code.\n* **`WRONG_TWO_FACTOR_CODE`:** Wrong two-factor code.\n* **`ACCESS_TOKEN_EXPIRED`:** Indicates that the access token is expired.\n* **`ACCESS_TOKEN_INVALID`:** Indicates that the access token cannot be decoded.","content":{"application/json":{"schema":{}}}},"403":{"description":"A specific domain error occurred (see list below):\n* **`STEP_UP_TOKEN_CREATION_FORBIDDEN`:** Thrown when a step-up token is requested from an illegal context.\n* **`STEP_UP_TOKEN_CREATION_FORBIDDEN`:** Thrown when a step-up token is requested from an illegal context.","content":{"application/json":{"schema":{}}}},"404":{"description":"A specific domain error occurred (see list below):\n* **`USER_NOT_FOUND`:** User not found.\n* **`USER_NOT_FOUND`:** User not found.","content":{"application/json":{"schema":{}}}},"500":{"description":"A specific domain error occurred (see list below):\n* **`DATABASE_FAILURE`:** Exception representing a general failure related to database operations.\n* **`INVALID_USER_DOCUMENT`:** A requested user document was stored in an invalid format.\n* **`ACCESS_TOKEN_ALLOWLIST_READING_FAILURE`:** Represents an exception indicating a failure when reading the allowlist for an access token cache.\n* **`STEP_UP_TOKEN_ENCODING_FAILURE`:** Represents an exception that occurs during the encoding process of a step-up token.\n* **`STEP_UP_TOKEN_SECRET_FAILURE`:** Represents an exception that occurs when there is a failure related to the secret required for creating a refresh token.\n* **`DATABASE_FAILURE`:** Exception representing a general failure related to database operations.\n* **`INVALID_USER_DOCUMENT`:** A requested user document was stored in an invalid format.\n* **`ACCESS_TOKEN_ALLOWLIST_READING_FAILURE`:** Represents an exception indicating a failure when reading the allowlist for an access token cache.\n* **`STEP_UP_TOKEN_ENCODING_FAILURE`:** Represents an exception that occurs during the encoding process of a step-up token.\n* **`STEP_UP_TOKEN_SECRET_FAILURE`:** Represents an exception that occurs when there is a failure related to the secret required for creating a refresh token.","content":{"application/json":{"schema":{}}}}}}
>
  
</StatusCodes>


      