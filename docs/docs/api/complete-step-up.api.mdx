---
id: complete-step-up
title: "Complete Step-Up"
description: "Perform second factor for step-up."
sidebar_label: "Complete Step-Up"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "post api-method"
info_path: docs/api/singularity-api
custom_edit_url: null
---

import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import ParamsDetails from "@theme/ParamsDetails";
import RequestSchema from "@theme/RequestSchema";
import StatusCodes from "@theme/StatusCodes";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";
import Heading from "@theme/Heading";

<Heading
  as={"h1"}
  className={"openapi__heading"}
  children={"Complete Step-Up"}
>
</Heading>

<MethodEndpoint
  method={"post"}
  path={"/api/auth/2fa/step-up"}
  context={"endpoint"}
>
  
</MethodEndpoint>



Perform second factor for step-up.

You can learn more about the step-up flow [here](../../docs/guides/auth/authentication#step-up).

### Requirements
- User authenticated using their password through [`POST /api/auth/step-up`](../../docs/api/step-up).
- At least one of [email](../../docs/guides/auth/two-factor#email) or [TOTP](../../docs/guides/auth/two-factor#totp) as 2FA methods should be enabled.
- An `email` or `totp` 2FA code is present for an enabled 2FA method.
  Check out [email](../../docs/guides/auth/two-factor#email) and [TOTP](../../docs/guides/auth/two-factor#totp)
  to learn how to retrieve a 2FA code.

### Tokens
- A valid [`AccessToken`](../../docs/guides/auth/tokens#access-token) is required.
- A valid [`TwoFactorAuthenticationToken`](../../docs/guides/auth/tokens#two-factor-authentication-token)
  is required. This token should match user and session contained in the `AccessToken`.
- If 2FA is disabled and the request is successful, [`StepUpToken`](../../docs/guides/auth/tokens#step-up-token)
  will automatically be set as HTTP-only cookie.
  If [header authentication](../../docs/guides/auth/authentication#header-authentication) is enabled,
  the [`StepUpToken`](../../docs/guides/auth/tokens#step-up-token)
  will be returned in the response body and can be used to authorized critical requests.

<Heading
  id={"request"}
  as={"h2"}
  className={"openapi-tabs__heading"}
  children={"Request"}
>
</Heading>

<ParamsDetails
  parameters={undefined}
>
  
</ParamsDetails>

<RequestSchema
  title={"Body"}
  body={{"content":{"application/json":{"schema":{"type":"object","properties":{"email":{"type":"string"},"totp":{"type":"integer","format":"int32"}},"title":"CompleteStepUpRequest"}}},"required":true}}
>
  
</RequestSchema>

<StatusCodes
  id={undefined}
  label={undefined}
  responses={{"200":{"description":"The token if header authentication is enabled.","content":{"*/*":{"schema":{"type":"object","properties":{"stepUpToken":{"type":"string"},"twoFactorRequired":{"type":"boolean"},"twoFactorMethods":{"type":"array","items":{"type":"string","enum":["totp","email"]}},"preferredTwoFactorMethod":{"type":"string","enum":["totp","email"]},"twoFactorAuthenticationToken":{"type":"string"}},"required":["twoFactorRequired"],"title":"StepUpResponse"}}}},"207":{"description":"The following error codes correspond to this status:\n* **`POST_COMMIT_SIDE_EFFECT_FAILURE`:** Exception representing a failure to perform a side effect after a successful database operation.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"400":{"description":"The following error codes correspond to this status:\n* **`NO_2FA_CODE_PROVIDED`:** Invalid request: at least one of email or totp must be provided.\n* **`NO_PASSWORD_PROVIDER`:** The user needs to set a password in to perform this action.\n* **`2FA_DISABLED`:** User needs to set up two-factor authentication to complete this action.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"401":{"description":"The following error codes correspond to this status:\n* **`TWO_FACTOR_AUTHENTICATION_TOKEN_EXPIRED`:** Indicates that the two-factor authentication token is expired.\n* **`TWO_FACTOR_AUTHENTICATION_TOKEN_INVALID`:** Indicates that the two-factor authentication token cannot be decoded.\n* **`TWO_FACTOR_AUTHENTICATION_TOKEN_MISSING`:** Thrown when the two-factor authentication token is missing.\n* **`TWO_FACTOR_CODE_EXPIRED`:** Two-factor code has expired.\n* **`TOTP_CODE_VALIDATION_FAILURE`:** Failed to validate TOTP code.\n* **`WRONG_TWO_FACTOR_CODE`:** Wrong two-factor code.\n* **`ACCESS_TOKEN_EXPIRED`:** Indicates that the access token is expired.\n* **`ACCESS_TOKEN_INVALID`:** Indicates that the access token cannot be decoded.\n* **`AUTHENTICATION_REQUIRED`:** User is not authenticated.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"403":{"description":"The following error codes correspond to this status:\n* **`STEP_UP_TOKEN_CREATION_FORBIDDEN`:** Thrown when a step-up token is requested from an illegal context.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"404":{"description":"The following error codes correspond to this status:\n* **`USER_NOT_FOUND`:** User not found.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"500":{"description":"The following error codes correspond to this status:\n* **`DATABASE_FAILURE`:** Exception representing a general failure related to database operations.\n* **`INVALID_USER_DOCUMENT`:** A requested user document was stored in an invalid format.\n* **`ACCESS_TOKEN_ALLOWLIST_READING_FAILURE`:** Represents an exception indicating a failure when reading the allowlist for an access token cache.\n* **`INVALID_DATABASE_OBJECT`:** Indicates an invalid document stored in the database.\n* **`STEP_UP_TOKEN_ENCODING_FAILURE`:** Represents an exception that occurs during the encoding process of a step-up token.\n* **`STEP_UP_TOKEN_SECRET_FAILURE`:** Represents an exception that occurs when there is a failure related to the secret required for creating a refresh token.\n* **`COOKIE_CREATION_FAILURE`:** Thrown when an exception occurred during the creation of a cookie.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}}}}
>
  
</StatusCodes>


      