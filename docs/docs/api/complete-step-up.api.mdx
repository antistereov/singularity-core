---
id: complete-step-up
title: "Complete Step-Up"
description: "Perform second factor for step-up."
sidebar_label: "Complete Step-Up"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "post api-method"
info_path: docs/api/singularity-api
custom_edit_url: null
---

import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import ParamsDetails from "@theme/ParamsDetails";
import RequestSchema from "@theme/RequestSchema";
import StatusCodes from "@theme/StatusCodes";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";
import Heading from "@theme/Heading";

<Heading
  as={"h1"}
  className={"openapi__heading"}
  children={"Complete Step-Up"}
>
</Heading>

<MethodEndpoint
  method={"post"}
  path={"/api/auth/2fa/step-up"}
  context={"endpoint"}
>
  
</MethodEndpoint>



Perform second factor for step-up.

You can learn more about the step-up flow [here](../../docs/guides/auth/authentication#step-up).

### Requirements
- User authenticated using their password through [`POST /api/auth/step-up`](../../docs/api/step-up).
- At least one of [email](../../docs/guides/auth/two-factor#email) or [TOTP](../../docs/guides/auth/two-factor#totp) as 2FA methods should be enabled.
- An `email` or `totp` 2FA code is present for an enabled 2FA method.
  Check out [email](../../docs/guides/auth/two-factor#email) and [TOTP](../../docs/guides/auth/two-factor#totp)
  to learn how to retrieve a 2FA code.

### Tokens
- A valid [`AccessToken`](../../docs/guides/auth/tokens#access-token) is required.
- A valid [`TwoFactorAuthenticationToken`](../../docs/guides/auth/tokens#two-factor-authentication-token)
  is required. This token should match user and session contained in the `AccessToken`.
- If 2FA is disabled and the request is successful, [`StepUpToken`](../../docs/guides/auth/tokens#step-up-token)
  will automatically be set as HTTP-only cookie.
  If [header authentication](../../docs/guides/auth/authentication#header-authentication) is enabled,
  the [`StepUpToken`](../../docs/guides/auth/tokens#step-up-token)
  will be returned in the response body and can be used to authorized critical requests.

<Heading
  id={"request"}
  as={"h2"}
  className={"openapi-tabs__heading"}
  children={"Request"}
>
</Heading>

<ParamsDetails
  parameters={undefined}
>
  
</ParamsDetails>

<RequestSchema
  title={"Body"}
  body={{"content":{"application/json":{"schema":{"type":"object","properties":{"email":{"type":"string"},"totp":{"type":"integer","format":"int32"}},"title":"CompleteStepUpRequest"}}},"required":true}}
>
  
</RequestSchema>

<StatusCodes
  id={undefined}
  label={undefined}
  responses={{"200":{"description":"The token if header authentication is enabled.","content":{"*/*":{"schema":{"type":"object","properties":{"stepUpToken":{"type":"string"},"twoFactorRequired":{"type":"boolean"},"twoFactorMethods":{"type":"array","items":{"type":"string","enum":["totp","email"]}},"preferredTwoFactorMethod":{"type":"string","enum":["totp","email"]},"twoFactorAuthenticationToken":{"type":"string"}},"required":["twoFactorRequired"],"title":"StepUpResponse"}}}},"400":{"description":"The following error codes correspond to this status:\n* **`NO_2FA_CODE_PROVIDED`:** Invalid request: at least one of email or totp must be provided.\n* **`NO_PASSWORD_PROVIDER`:** The user needs to set a password in to perform this action.\n* **`2FA_DISABLED`:** User needs to set up two-factor authentication to complete this action.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"401":{"description":"The following error codes correspond to this status:\n* **`TWO_FACTOR_AUTHENTICATION_TOKEN_EXPIRED`:** Indicates that the two-factor authentication token is expired.\n* **`TWO_FACTOR_AUTHENTICATION_TOKEN_INVALID`:** Indicates that the two-factor authentication token cannot be decoded.\n* **`TWO_FACTOR_AUTHENTICATION_TOKEN_MISSING`:** Thrown when the two-factor authentication token is missing.\n* **`TWO_FACTOR_CODE_EXPIRED`:** Two-factor code has expired.\n* **`TOTP_CODE_VALIDATION_FAILURE`:** Failed to validate TOTP code.\n* **`WRONG_TWO_FACTOR_CODE`:** Wrong two-factor code.\n* **`ACCESS_TOKEN_EXPIRED`:** Indicates that the access token is expired.\n* **`ACCESS_TOKEN_INVALID`:** Indicates that the access token cannot be decoded.\n* **`AUTHENTICATION_REQUIRED`:** User is not authenticated.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"403":{"description":"The following error codes correspond to this status:\n* **`STEP_UP_TOKEN_CREATION_FORBIDDEN`:** Thrown when a step-up token is requested from an illegal context.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"404":{"description":"The following error codes correspond to this status:\n* **`USER_NOT_FOUND`:** User not found.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"500":{"description":"The following error codes correspond to this status:\n* **`DATABASE_FAILURE`:** Exception representing a general failure related to database operations.\n* **`INVALID_USER_DOCUMENT`:** A requested user document was stored in an invalid format.\n* **`POST_COMMIT_SIDE_EFFECT_FAILURE`:** Exception representing a failure to perform a side effect after a successful database operation.\n* **`ACCESS_TOKEN_ALLOWLIST_READING_FAILURE`:** Represents an exception indicating a failure when reading the allowlist for an access token cache.\n* **`INVALID_DATABASE_OBJECT`:** Indicates an invalid document stored in the database.\n* **`STEP_UP_TOKEN_ENCODING_FAILURE`:** Represents an exception that occurs during the encoding process of a step-up token.\n* **`STEP_UP_TOKEN_SECRET_FAILURE`:** Represents an exception that occurs when there is a failure related to the secret required for creating a refresh token.\n* **`COOKIE_CREATION_FAILURE`:** Thrown when an exception occurred during the creation of a cookie.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}}}}
>
  
</StatusCodes>


      