---
id: complete-step-up
title: "Complete Step-Up"
description: "Perform second factor for step-up."
sidebar_label: "Complete Step-Up"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "post api-method"
info_path: docs/api/singularity-api
custom_edit_url: null
---

import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import ParamsDetails from "@theme/ParamsDetails";
import RequestSchema from "@theme/RequestSchema";
import StatusCodes from "@theme/StatusCodes";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";
import Heading from "@theme/Heading";

<Heading
  as={"h1"}
  className={"openapi__heading"}
  children={"Complete Step-Up"}
>
</Heading>

<MethodEndpoint
  method={"post"}
  path={"/api/auth/2fa/step-up"}
  context={"endpoint"}
>
  
</MethodEndpoint>



Perform second factor for step-up.

You can learn more about the step-up flow [here](../../docs/guides/auth/authentication#step-up).

### Requirements
- User authenticated using their password through [`POST /api/auth/step-up`](../../docs/api/step-up).
- At least one of [email](../../docs/guides/auth/two-factor#email) or [TOTP](../../docs/guides/auth/two-factor#totp) as 2FA methods should be enabled.
- An `email` or `totp` 2FA code is present for an enabled 2FA method.
  Check out [email](../../docs/guides/auth/two-factor#email) and [TOTP](../../docs/guides/auth/two-factor#totp)
  to learn how to retrieve a 2FA code.

### Tokens
- A valid [`AccessToken`](../../docs/guides/auth/tokens#access-token) is required.
- A valid [`TwoFactorAuthenticationToken`](../../docs/guides/auth/tokens#two-factor-authentication-token)
  is required. This token should match user and session contained in the `AccessToken`.
- If 2FA is disabled and the request is successful, [`StepUpToken`](../../docs/guides/auth/tokens#step-up-token)
  will automatically be set as HTTP-only cookie.
  If [header authentication](../../docs/guides/auth/authentication#header-authentication) is enabled,
  the [`StepUpToken`](../../docs/guides/auth/tokens#step-up-token)
  will be returned in the response body and can be used to authorized critical requests.

<Heading
  id={"request"}
  as={"h2"}
  className={"openapi-tabs__heading"}
  children={"Request"}
>
</Heading>

<ParamsDetails
  parameters={undefined}
>
  
</ParamsDetails>

<RequestSchema
  title={"Body"}
  body={{"content":{"application/json":{"schema":{"type":"object","properties":{"email":{"type":"string"},"totp":{"type":"integer","format":"int32"}},"title":"CompleteStepUpRequest"}}},"required":true}}
>
  
</RequestSchema>

<StatusCodes
  id={undefined}
  label={undefined}
  responses={{"200":{"description":"The token if header authentication is enabled.","content":{"*/*":{"schema":{"type":"object","properties":{"stepUpToken":{"type":"string"},"twoFactorRequired":{"type":"boolean"},"twoFactorMethods":{"type":"array","items":{"type":"string","enum":["totp","email"]}},"preferredTwoFactorMethod":{"type":"string","enum":["totp","email"]},"twoFactorAuthenticationToken":{"type":"string"}},"required":["twoFactorRequired"],"title":"StepUpResponse"}}}},"207":{"description":"The following error codes correspond to this status:\n* **`POST_COMMIT_SIDE_EFFECT_FAILURE`:** Exception representing a failure to perform a side effect after a successful database operation.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"400":{"description":"The following error codes correspond to this status:\n* **`NO_2FA_CODE_PROVIDED`:** Invalid request: at least one of email or totp must be provided.\n* **`NO_PASSWORD_PROVIDER`:** The user needs to set a password in to perform this action.\n* **`2FA_DISABLED`:** User needs to set up two-factor authentication to complete this action.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"401":{"description":"The following error codes correspond to this status:\n* **`TWO_FACTOR_AUTHENTICATION_TOKEN_EXPIRED`:** Indicates that the two-factor authentication token is expired.\n* **`TWO_FACTOR_AUTHENTICATION_TOKEN_INVALID`:** Indicates that the two-factor authentication token cannot be decoded.\n* **`TWO_FACTOR_AUTHENTICATION_TOKEN_MISSING`:** Thrown when the two-factor authentication token is missing.\n* **`TWO_FACTOR_CODE_EXPIRED`:** Two-factor code has expired.\n* **`TOTP_CODE_VALIDATION_FAILURE`:** Failed to validate TOTP code.\n* **`WRONG_TWO_FACTOR_CODE`:** Wrong two-factor code.\n* **`ACCESS_TOKEN_EXPIRED`:** Indicates that the access token is expired.\n* **`ACCESS_TOKEN_INVALID`:** Indicates that the access token cannot be decoded.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"403":{"description":"The following error codes correspond to this status:\n* **`STEP_UP_TOKEN_CREATION_FORBIDDEN`:** Thrown when a step-up token is requested from an illegal context.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"404":{"description":"The following error codes correspond to this status:\n* **`USER_NOT_FOUND`:** User not found.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}},"500":{"description":"The following error codes correspond to this status:\n* **`DATABASE_FAILURE`:** Exception representing a general failure related to database operations.\n* **`INVALID_USER_DOCUMENT`:** A requested user document was stored in an invalid format.\n* **`ACCESS_TOKEN_ALLOWLIST_READING_FAILURE`:** Represents an exception indicating a failure when reading the allowlist for an access token cache.\n* **`STEP_UP_TOKEN_ENCODING_FAILURE`:** Represents an exception that occurs during the encoding process of a step-up token.\n* **`STEP_UP_TOKEN_SECRET_FAILURE`:** Represents an exception that occurs when there is a failure related to the secret required for creating a refresh token.","content":{"application/json":{"schema":{"type":"object","properties":{"timestamp":{"type":"string"},"status":{"type":"integer","format":"int32"},"code":{"type":"string"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["code","error","status","timestamp"],"title":"ErrorResponse"}}}}}}
>
  
</StatusCodes>


      