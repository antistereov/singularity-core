---
id: recover-from-totp
title: "Recover From TOTP"
description: "Recover the user if they lost access to their 2FA device. After successful recovery, an AccessToken, RefreshToken and StepUpToken will be set as HTTP-only cookies and returned in the response body if header authentication is enabled."
sidebar_label: "Recover From TOTP"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "post api-method"
info_path: docs/api/singularity-api
custom_edit_url: null
---

import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import ParamsDetails from "@theme/ParamsDetails";
import RequestSchema from "@theme/RequestSchema";
import StatusCodes from "@theme/StatusCodes";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";
import Heading from "@theme/Heading";

<Heading
  as={"h1"}
  className={"openapi__heading"}
  children={"Recover From TOTP"}
>
</Heading>

<MethodEndpoint
  method={"post"}
  path={"/api/auth/2fa/totp/recover"}
  context={"endpoint"}
>
  
</MethodEndpoint>



Recover the user if they lost access to their 2FA device. After successful recovery, an AccessToken, RefreshToken and StepUpToken will be set as HTTP-only cookies and returned in the response body if header authentication is enabled.

<Heading
  id={"request"}
  as={"h2"}
  className={"openapi-tabs__heading"}
  children={"Request"}
>
</Heading>

<ParamsDetails
  parameters={[{"name":"code","in":"query","required":true,"schema":{"type":"string"}}]}
>
  
</ParamsDetails>

<RequestSchema
  title={"Body"}
  body={{"content":{"application/json":{"schema":{"type":"object","properties":{"browser":{"type":"string","description":"The name of the browser used.","example":"Chrome"},"os":{"type":"string","description":"The operating system of the device.","example":"WIndows"}},"title":"SessionInfoRequest"}}}}}
>
  
</RequestSchema>

<StatusCodes
  id={undefined}
  label={undefined}
  responses={{"200":{"description":"Recovery successful. If header authentication is enabled, the response will contain all tokens.","content":{"*/*":{"schema":{"type":"object","properties":{"user":{"type":"object","properties":{"id":{"type":"object","properties":{"timestamp":{"type":"integer","format":"int32"},"date":{"type":"string","format":"date-time"}},"title":"ObjectId"},"name":{"type":"string"},"email":{"type":"string"},"identityProviders":{"type":"array","items":{"type":"string"}},"roles":{"type":"array","items":{"type":"string","enum":["USER","ADMIN","GUEST"]},"uniqueItems":true},"emailVerified":{"type":"boolean"},"lastActive":{"type":"string"},"twoFactorAuthEnabled":{"type":"boolean"},"preferredTwoFactorMethod":{"type":"string","enum":["totp","mail"]},"twoFactorAuthMethods":{"type":"array","items":{"type":"string","enum":["totp","mail"]}},"avatar":{"type":"object","properties":{"id":{"type":"object","properties":{"timestamp":{"type":"integer","format":"int32"},"date":{"type":"string","format":"date-time"}},"title":"ObjectId"},"key":{"type":"string"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"},"access":{"type":"object","properties":{"ownerId":{"type":"object","properties":{"timestamp":{"type":"integer","format":"int32"},"date":{"type":"string","format":"date-time"}},"title":"ObjectId"},"visibility":{"type":"string","enum":["PRIVATE","PUBLIC","SHARED"]},"users":{"type":"object","properties":{"admin":{"type":"array","items":{"type":"string"},"uniqueItems":true},"editor":{"type":"array","items":{"type":"string"},"uniqueItems":true},"viewer":{"type":"array","items":{"type":"string"},"uniqueItems":true},"isEmpty":{"type":"boolean"}},"required":["admin","editor","isEmpty","viewer"],"title":"ContentAccessPermissions"},"groups":{"type":"object","properties":{"admin":{"type":"array","items":{"type":"string"},"uniqueItems":true},"editor":{"type":"array","items":{"type":"string"},"uniqueItems":true},"viewer":{"type":"array","items":{"type":"string"},"uniqueItems":true},"isEmpty":{"type":"boolean"}},"required":["admin","editor","isEmpty","viewer"],"title":"ContentAccessPermissions"},"invitations":{"type":"array","items":{"type":"object","properties":{"timestamp":{"type":"integer","format":"int32"},"date":{"type":"string","format":"date-time"}},"title":"ObjectId"},"uniqueItems":true}},"required":["groups","invitations","ownerId","users","visibility"],"title":"ContentAccessDetails"},"contentType":{"type":"string"},"url":{"type":"string"},"size":{"type":"integer","format":"int64"},"trusted":{"type":"boolean"},"tags":{"type":"array","items":{"type":"string"},"uniqueItems":true}},"required":["access","contentType","createdAt","id","key","size","tags","trusted","updatedAt","url"],"title":"FileMetadataResponse"},"created":{"type":"string"},"groups":{"type":"array","items":{"type":"string"},"uniqueItems":true}},"required":["created","emailVerified","groups","id","identityProviders","lastActive","name","roles","twoFactorAuthEnabled","twoFactorAuthMethods"],"title":"UserResponse"},"accessToken":{"type":"string"},"refreshToken":{"type":"string"},"stepUpToken":{"type":"string"},"sessionToken":{"type":"string"}},"required":["user"],"title":"TwoFactorRecoveryResponse"}}}},"401":{"description":"Wrong code.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}},"403":{"description":"User is already authenticated.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}}}}
>
  
</StatusCodes>


      