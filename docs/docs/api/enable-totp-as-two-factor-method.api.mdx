---
id: enable-totp-as-two-factor-method
title: "Enable TOTP as 2FA Method"
description: "Complete the TOTP setup `token` from [`GET /api/auth/2fa/setup`](https://singularity.stereov.io/docs/api/get-totp-setup-details)"
sidebar_label: "Enable TOTP as 2FA Method"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "post api-method"
info_path: docs/api/singularity-api
custom_edit_url: null
---

import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import ParamsDetails from "@theme/ParamsDetails";
import RequestSchema from "@theme/RequestSchema";
import StatusCodes from "@theme/StatusCodes";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";
import Heading from "@theme/Heading";

<Heading
  as={"h1"}
  className={"openapi__heading"}
  children={"Enable TOTP as 2FA Method"}
>
</Heading>

<MethodEndpoint
  method={"post"}
  path={"/api/auth/2fa/totp/setup"}
  context={"endpoint"}
>
  
</MethodEndpoint>



Complete the TOTP setup `token` from [`GET /api/auth/2fa/setup`](https://singularity.stereov.io/docs/api/get-totp-setup-details) 
and a TOTP code from an authenticator app.

You can learn more about this [here](https://singularity.stereov.io/docs/guides/auth/two-factor#setup).

**Requirements:**
- The user can authenticate using password. 2FA will not work with OAuth2. 
  The OAuth2 provider will validate the second factor if the user enabled it for the provider.
  
**Tokens:**
- A valid [`AccessToken`](https://singularity.stereov.io/docs/guides/auth/tokens#access-token) is required.
- A valid [`StepUpToken`](https://singularity.stereov.io/docs/guides/auth/tokens#step-up-token)
  is required. This token should match user and session contained in the `AccessToken`.

<Heading
  id={"request"}
  as={"h2"}
  className={"openapi-tabs__heading"}
  children={"Request"}
>
</Heading>

<ParamsDetails
  parameters={undefined}
>
  
</ParamsDetails>

<RequestSchema
  title={"Body"}
  body={{"content":{"application/json":{"schema":{"type":"object","properties":{"token":{"type":"string"},"code":{"type":"integer","format":"int32"}},"required":["code","token"],"title":"TwoFactorVerifySetupRequest"}}},"required":true}}
>
  
</RequestSchema>

<StatusCodes
  id={undefined}
  label={undefined}
  responses={{"200":{"description":"Success.","content":{"*/*":{"schema":{"type":"object","properties":{"secret":{"type":"string"},"totpAuthUrl":{"type":"string"},"recoveryCodes":{"type":"array","items":{"type":"string"}},"token":{"type":"string"}},"required":["recoveryCodes","secret","token","totpAuthUrl"],"title":"TwoFactorSetupResponse"}}}},"304":{"description":"The user already enabled TOTP.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}},"400":{"description":"2FA cannot be enabled for users who didn't configure authentication using a password.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}},"401":{"description":"`AccessToken` or `StepUpToken` is invalid.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}}}}
>
  
</StatusCodes>


      