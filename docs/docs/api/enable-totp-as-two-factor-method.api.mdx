---
id: enable-totp-as-two-factor-method
title: "Enable TOTP as 2FA Method"
description: "Complete the TOTP setup `token` from [`GET /api/auth/2fa/setup`](https://singularity.stereov.io/docs/api/get-totp-setup-details)"
sidebar_label: "Enable TOTP as 2FA Method"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "post api-method"
info_path: docs/api/singularity-api
custom_edit_url: null
---

import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import ParamsDetails from "@theme/ParamsDetails";
import RequestSchema from "@theme/RequestSchema";
import StatusCodes from "@theme/StatusCodes";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";
import Heading from "@theme/Heading";

<Heading
  as={"h1"}
  className={"openapi__heading"}
  children={"Enable TOTP as 2FA Method"}
>
</Heading>

<MethodEndpoint
  method={"post"}
  path={"/api/auth/2fa/totp/setup"}
  context={"endpoint"}
>
  
</MethodEndpoint>



Complete the TOTP setup `token` from [`GET /api/auth/2fa/setup`](https://singularity.stereov.io/docs/api/get-totp-setup-details) 
and a TOTP code from an authenticator app.

You can learn more about this [here](https://singularity.stereov.io/docs/guides/auth/two-factor#setup).

A [security alert](https://singularity.stereov.io/docs/guides/auth/security-alerts#2fa-specific-alerts)
will be sent to the user's email if this setting is enabled and
email is [enabled and configured correctly](https://singularity.stereov.io/docs/guides/email/configuration).

### Requirements
- The user can authenticate using password. 2FA will not work with OAuth2. 
  The OAuth2 provider will validate the second factor if the user enabled it for the provider.
  
### Locale

A locale can be specified for this request. 
The email will be sent in the specified locale.
You can learn more about locale in emails [here](https://singularity.stereov.io/docs/guides/email/templates).

If no locale is specified, the applications default locale will be used.
You can learn more about configuring the default locale [here](https://singularity.stereov.io/docs/guides/configuration).

### Tokens
- A valid [`AccessToken`](https://singularity.stereov.io/docs/guides/auth/tokens#access-token) is required.
- A valid [`StepUpToken`](https://singularity.stereov.io/docs/guides/auth/tokens#step-up-token)
  is required. This token should match user and session contained in the `AccessToken`.

<Heading
  id={"request"}
  as={"h2"}
  className={"openapi-tabs__heading"}
  children={"Request"}
>
</Heading>

<ParamsDetails
  parameters={[{"name":"locale","in":"query","required":false,"schema":{"type":"string"}}]}
>
  
</ParamsDetails>

<RequestSchema
  title={"Body"}
  body={{"content":{"application/json":{"schema":{"type":"object","properties":{"token":{"type":"string"},"code":{"type":"integer","format":"int32"}},"required":["code","token"],"title":"TwoFactorVerifySetupRequest"}}},"required":true}}
>
  
</RequestSchema>

<StatusCodes
  id={undefined}
  label={undefined}
  responses={{"200":{"description":"Success.","content":{"*/*":{"schema":{"type":"object","properties":{"secret":{"type":"string"},"totpAuthUrl":{"type":"string"},"recoveryCodes":{"type":"array","items":{"type":"string"}},"token":{"type":"string"}},"required":["recoveryCodes","secret","token","totpAuthUrl"],"title":"TwoFactorSetupResponse"}}}},"304":{"description":"The user already enabled TOTP.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}},"400":{"description":"2FA cannot be enabled for users who didn't configure authentication using a password.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}},"401":{"description":"`AccessToken` or `StepUpToken` is invalid.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}}}}
>
  
</StatusCodes>


      