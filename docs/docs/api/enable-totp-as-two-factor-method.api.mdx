---
id: enable-totp-as-two-factor-method
title: "Enable TOTP as 2FA Method"
description: "Complete the TOTP setup `token` from [`GET /api/auth/2fa/setup`](../../docs/api/get-totp-setup-details)"
sidebar_label: "Enable TOTP as 2FA Method"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "post api-method"
info_path: docs/api/singularity-api
custom_edit_url: null
---

import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import ParamsDetails from "@theme/ParamsDetails";
import RequestSchema from "@theme/RequestSchema";
import StatusCodes from "@theme/StatusCodes";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";
import Heading from "@theme/Heading";

<Heading
  as={"h1"}
  className={"openapi__heading"}
  children={"Enable TOTP as 2FA Method"}
>
</Heading>

<MethodEndpoint
  method={"post"}
  path={"/api/auth/2fa/totp/setup"}
  context={"endpoint"}
>
  
</MethodEndpoint>



Complete the TOTP setup `token` from [`GET /api/auth/2fa/setup`](../../docs/api/get-totp-setup-details) 
and a TOTP code from an authenticator app.

You can learn more about this [here](../../docs/guides/auth/two-factor#setup).

A [security alert](../../docs/guides/auth/security-alerts#2fa-specific-alerts)
will be sent to the user's email if this setting is enabled and
email is [enabled and configured correctly](../../docs/guides/email/configuration).

**Requirements:**
- The user can authenticate using password. 2FA will not work with OAuth2. 
  The OAuth2 provider will validate the second factor if the user enabled it for the provider.
  
**Locale:**

A locale can be specified for this request. 
The email will be sent in the specified locale.
You can learn more about locale in emails [here](../../docs/guides/email/templates).

If no locale is specified, the applications default locale will be used.
You can learn more about configuring the default locale [here](../../docs/guides/configuration).

**Tokens:**
- A valid [`AccessToken`](../../docs/guides/auth/tokens#access-token) is required.
- A valid [`StepUpToken`](../../docs/guides/auth/tokens#step-up-token)
  is required. This token should match user and session contained in the `AccessToken`.

<Heading
  id={"request"}
  as={"h2"}
  className={"openapi-tabs__heading"}
  children={"Request"}
>
</Heading>

<ParamsDetails
  parameters={[{"name":"locale","in":"query","required":false,"schema":{"type":"string"}}]}
>
  
</ParamsDetails>

<RequestSchema
  title={"Body"}
  body={{"content":{"application/json":{"schema":{"type":"object","properties":{"token":{"type":"string"},"code":{"type":"integer","format":"int32"}},"required":["code","token"],"title":"TwoFactorVerifySetupRequest"}}},"required":true}}
>
  
</RequestSchema>

<StatusCodes
  id={undefined}
  label={undefined}
  responses={{"200":{"description":"Success.","content":{"*/*":{"schema":{"type":"object","properties":{"secret":{"type":"string"},"totpAuthUrl":{"type":"string"},"recoveryCodes":{"type":"array","items":{"type":"string"}},"token":{"type":"string"}},"required":["recoveryCodes","secret","token","totpAuthUrl"],"title":"TwoFactorSetupResponse"}}}},"304":{"description":"The user already enabled TOTP.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}},"400":{"description":"2FA cannot be enabled for users who didn't configure authentication using a password.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}},"401":{"description":"`AccessToken` or `StepUpToken` is invalid.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}}}}
>
  
</StatusCodes>


      