---
id: enable-totp-as-two-factor-method
title: "Enable TOTP as 2FA Method"
description: "Complete the TOTP setup `token` from [`GET /api/auth/2fa/setup`](https://singularity.stereov.io/docs/api/get-totp-setup-details)"
sidebar_label: "Enable TOTP as 2FA Method"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "post api-method"
info_path: docs/api/singularity-api
custom_edit_url: null
---

import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import ParamsDetails from "@theme/ParamsDetails";
import RequestSchema from "@theme/RequestSchema";
import StatusCodes from "@theme/StatusCodes";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";
import Heading from "@theme/Heading";

<Heading
  as={"h1"}
  className={"openapi__heading"}
  children={"Enable TOTP as 2FA Method"}
>
</Heading>

<MethodEndpoint
  method={"post"}
  path={"/api/auth/2fa/totp/setup"}
  context={"endpoint"}
>
  
</MethodEndpoint>



Complete the TOTP setup `token` from [`GET /api/auth/2fa/setup`](https://singularity.stereov.io/docs/api/get-totp-setup-details) 
and a TOTP code from an authenticator app.

You can learn more about this [here](https://singularity.stereov.io/docs/guides/auth/two-factor#setup).

**Requirements:**
- The user can authenticate using password. 2FA will not work with OAuth2. 
  The OAuth2 provider will validate the second factor if the user enabled it for the provider.
  
**Tokens:**
- A valid [`AccessToken`](https://singularity.stereov.io/docs/guides/auth/tokens#access-token) is required.
- A valid [`StepUpToken`](https://singularity.stereov.io/docs/guides/auth/tokens#step-up-token)
  is required. This token should match user and session contained in the `AccessToken`.

<Heading
  id={"request"}
  as={"h2"}
  className={"openapi-tabs__heading"}
  children={"Request"}
>
</Heading>

<ParamsDetails
  parameters={undefined}
>
  
</ParamsDetails>

<RequestSchema
  title={"Body"}
  body={{"content":{"application/json":{"schema":{"type":"object","properties":{"token":{"type":"string"},"code":{"type":"integer","format":"int32"}},"required":["code","token"],"title":"TwoFactorVerifySetupRequest"}}},"required":true}}
>
  
</RequestSchema>

<StatusCodes
  id={undefined}
  label={undefined}
  responses={{"200":{"description":"Success.","content":{"*/*":{"schema":{"type":"object","properties":{"secret":{"type":"string"},"totpAuthUrl":{"type":"string"},"recoveryCodes":{"type":"array","items":{"type":"string"}},"token":{"type":"string"}},"required":["recoveryCodes","secret","token","totpAuthUrl"],"title":"TwoFactorSetupResponse"}}}},"304":{"description":"The user already enabled TOTP.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}},"400":{"description":"2FA cannot be enabled for users who didn't configure authentication using a password.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}},"401":{"description":"`AccessToken` or `StepUpToken` is invalid.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}}}}
>
  
</StatusCodes>


      