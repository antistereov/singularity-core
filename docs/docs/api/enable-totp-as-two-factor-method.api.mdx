---
id: enable-totp-as-two-factor-method
title: "Enable TOTP as 2FA Method"
description: "Complete the TOTP setup `token` from [`GET /api/auth/2fa/setup`](https://singularity.stereov.io/docs/api/get-totp-setup-details)"
sidebar_label: "Enable TOTP as 2FA Method"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "post api-method"
info_path: docs/api/singularity-api
custom_edit_url: null
---

import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import ParamsDetails from "@theme/ParamsDetails";
import RequestSchema from "@theme/RequestSchema";
import StatusCodes from "@theme/StatusCodes";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";
import Heading from "@theme/Heading";

<Heading
  as={"h1"}
  className={"openapi__heading"}
  children={"Enable TOTP as 2FA Method"}
>
</Heading>

<MethodEndpoint
  method={"post"}
  path={"/api/auth/2fa/totp/setup"}
  context={"endpoint"}
>
  
</MethodEndpoint>



Complete the TOTP setup `token` from [`GET /api/auth/2fa/setup`](https://singularity.stereov.io/docs/api/get-totp-setup-details) 
and a TOTP code from an authenticator app.

You can learn more about this [here](https://singularity.stereov.io/docs/guides/auth/two-factor#setup).

A [security alert](https://singularity.stereov.io/docs/guides/auth/security-alerts#2fa-specific-alerts)
will be sent to the user's email if this setting is enabled and
email is [enabled and configured correctly](https://singularity.stereov.io/docs/guides/email/configuration).

### Requirements
- The user can authenticate using password. 2FA will not work with OAuth2. 
  The OAuth2 provider will validate the second factor if the user enabled it for the provider.
  
### Locale

A locale can be specified for this request. 
The email will be sent in the specified locale.
You can learn more about locale in emails [here](https://singularity.stereov.io/docs/guides/email/templates).

If no locale is specified, the applications default locale will be used.
You can learn more about configuring the default locale [here](https://singularity.stereov.io/docs/guides/configuration).

### Tokens
- A valid [`AccessToken`](https://singularity.stereov.io/docs/guides/auth/tokens#access-token) is required.
- A valid [`StepUpToken`](https://singularity.stereov.io/docs/guides/auth/tokens#step-up-token)
  is required. This token should match user and session contained in the `AccessToken`.

<Heading
  id={"request"}
  as={"h2"}
  className={"openapi-tabs__heading"}
  children={"Request"}
>
</Heading>

<ParamsDetails
  parameters={[{"name":"locale","in":"query","required":false,"schema":{"type":"string"}}]}
>
  
</ParamsDetails>

<RequestSchema
  title={"Body"}
  body={{"content":{"application/json":{"schema":{"type":"object","properties":{"token":{"type":"string"},"code":{"type":"integer","format":"int32"}},"required":["code","token"],"title":"TwoFactorVerifySetupRequest"}}},"required":true}}
>
  
</RequestSchema>

<StatusCodes
  id={undefined}
  label={undefined}
  responses={{"200":{"description":"Success.","content":{"*/*":{"schema":{"type":"object","properties":{"secret":{"type":"string"},"totpAuthUrl":{"type":"string"},"recoveryCodes":{"type":"array","items":{"type":"string"}},"token":{"type":"string"}},"required":["recoveryCodes","secret","token","totpAuthUrl"],"title":"TwoFactorSetupResponse"}}}},"304":{"description":"The user already enabled TOTP.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}},"400":{"description":"2FA cannot be enabled for users who didn't configure authentication using a password.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}},"401":{"description":"`AccessToken` or `StepUpToken` is invalid.","content":{"*/*":{"schema":{"type":"object","properties":{"timestamp":{"type":"string","format":"date-time"},"status":{"type":"integer","format":"int32"},"error":{"type":"string"},"message":{"type":"string"},"path":{"type":"string"}},"required":["error","status","timestamp"],"title":"ErrorResponse"}}}}}}
>
  
</StatusCodes>


      